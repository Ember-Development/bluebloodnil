generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  ATHLETE
  STAFF
  ADMIN
  BRAND_REP
}

enum CampaignStatus {
  DRAFT
  ACTIVE
  COMPLETED
  ARCHIVED
}

enum ParticipantStatus {
  INVITED
  APPLIED
  ACCEPTED
  DECLINED
  COMPLETED
}

model User {
  id         String          @id @default(cuid())
  email      String          @unique
  role       UserRole
  externalId String?         @unique
  athlete    AthleteProfile?
  createdAt  DateTime        @default(now())
  updatedAt  DateTime        @updatedAt
}

model AthleteProfile {
  id           String                @id @default(cuid())
  user         User                  @relation(fields: [userId], references: [id])
  userId       String                @unique
  name         String
  position     String?
  school       String?
  classYear    Int?
  bio          String?
  nilScore     Int?
  contents     Content[]
  participants CampaignParticipant[]
}

model Organization {
  id         String      @id @default(cuid())
  name       String
  logoUrl    String?
  tier       String?
  campaigns  Campaign[]
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
}

model Campaign {
  id             String                @id @default(cuid())
  title          String
  description    String?
  status         CampaignStatus        @default(DRAFT)
  organization   Organization          @relation(fields: [organizationId], references: [id])
  organizationId String
  participants   CampaignParticipant[]
  createdAt      DateTime              @default(now())
  updatedAt      DateTime              @updatedAt
}

model CampaignParticipant {
  id         String             @id @default(cuid())
  campaign   Campaign           @relation(fields: [campaignId], references: [id])
  campaignId String
  athlete    AthleteProfile     @relation(fields: [athleteId], references: [id])
  athleteId  String
  status     ParticipantStatus  @default(INVITED)
  createdAt  DateTime           @default(now())
  updatedAt  DateTime           @updatedAt
}

model Content {
  id        String          @id @default(cuid())
  athlete   AthleteProfile  @relation(fields: [athleteId], references: [id])
  athleteId String
  type      String
  mediaUrl  String
  caption   String?
  createdAt DateTime        @default(now())
}

